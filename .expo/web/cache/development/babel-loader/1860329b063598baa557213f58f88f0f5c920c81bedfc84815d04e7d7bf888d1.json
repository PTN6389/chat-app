{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { useState } from \"react\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport View from \"react-native-web/dist/exports/View\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { useActionSheet } from \"@expo/react-native-action-sheet\";\nimport * as ImagePicker from \"expo-image-picker\";\nimport * as Location from \"expo-location\";\nimport { ref, uploadBytes, getDownloadURL } from \"firebase/storage\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar CustomActions = function CustomActions(_ref) {\n  var wrapperStyle = _ref.wrapperStyle,\n    iconTextStyle = _ref.iconTextStyle,\n    onSend = _ref.onSend,\n    storage = _ref.storage,\n    userID = _ref.userID;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    image = _useState2[0],\n    setImage = _useState2[1];\n  var _useState3 = useState(null),\n    _useState4 = _slicedToArray(_useState3, 2),\n    location = _useState4[0],\n    setLocation = _useState4[1];\n  var actionSheet = useActionSheet();\n  var uploadAndSendImage = function () {\n    var _ref2 = _asyncToGenerator(function* (imageURI) {\n      var uniqueRefString = generateReference(imageURI);\n      var newUploadRef = ref(storage, uniqueRefString);\n      var response = yield fetch(imageUIR);\n      var blob = yield response.blob();\n      uploadBytes(newUploadRef, blob).then(function () {\n        var _ref3 = _asyncToGenerator(function* (snapshot) {\n          var imageURL = yield getDownloadURL(snapshot.ref);\n          onSend({\n            image: imageURL\n          });\n        });\n        return function (_x2) {\n          return _ref3.apply(this, arguments);\n        };\n      }());\n    });\n    return function uploadAndSendImage(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var pickImage = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      var permissions = yield ImagePicker.requestMediaLibraryPermissionsAsync();\n      if (permissions != null && permissions.granted) {\n        var result = yield ImagePicker.launchImageLibraryAsync();\n        if (!result.canceled) yield uploadAndSendImage(result.assets[0].uri);else Alert.alert(\"Permissions haven't been granted.\");\n      }\n    });\n    return function pickImage() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  var generateReference = function generateReference(uri) {\n    var timeStamp = new Date().getTime();\n    var imageName = uri.split(\"/\")[uri.split(\"/\").length - 1];\n    return userID + \"-\" + timeStamp + \"-\" + imageName;\n  };\n  var takePhoto = function () {\n    var _ref5 = _asyncToGenerator(function* () {\n      var permissions = yield ImagePicker.requestCameraPermissionsAsync();\n      if (permissions != null && permissions.granted) {\n        var result = yield ImagePicker.launchCameraAsync();\n        if (!result.canceled) yield uploadAndSendImage(result.assets[0].uri);else Alert.alert(\"Permissions haven't been granted.\");\n      }\n    });\n    return function takePhoto() {\n      return _ref5.apply(this, arguments);\n    };\n  }();\n  var getLocation = function () {\n    var _ref6 = _asyncToGenerator(function* () {\n      var permissions = yield Location.requestForegroundPermissionsAsync();\n      if (permissions != null && permissions.granted) {\n        var _location = yield Location.getCurrentPositionAsync({});\n        if (_location) {\n          onSend({\n            location: {\n              longitude: _location.coords.longitude,\n              latitude: _location.coords.latitude\n            }\n          });\n        } else Alert.alert(\"Error occurred while fetching location\");\n      } else Alert.alert(\"Permissions to read location aren't granted\");\n    });\n    return function getLocation() {\n      return _ref6.apply(this, arguments);\n    };\n  }();\n  var onActionPress = function onActionPress() {\n    var options = [\"Choose From Library\", \"Take Picture\", \"Send Location\", \"Cancel\"];\n    var cancelButtonIndex = options.length - 1;\n    actionSheet.showActionSheetWithOptions({\n      options: options,\n      cancelButtonIndex: cancelButtonIndex\n    }, function () {\n      var _ref7 = _asyncToGenerator(function* (buttonIndex) {\n        switch (buttonIndex) {\n          case 0:\n            pickImage();\n            return;\n          case 1:\n            takePhoto();\n            return;\n          case 2:\n            getLocation();\n          default:\n        }\n      });\n      return function (_x3) {\n        return _ref7.apply(this, arguments);\n      };\n    }());\n  };\n  return _jsx(TouchableOpacity, {\n    style: styles.container,\n    onPress: onActionPress,\n    children: _jsx(View, {\n      style: [styles.wrapper, wrapperStyle],\n      children: _jsx(Text, {\n        style: [styles.iconText, iconTextStyle],\n        children: \"+\"\n      })\n    })\n  });\n};\nvar styles = StyleSheet.create({\n  container: {\n    width: 26,\n    height: 26,\n    marginLeft: 10,\n    marginBottom: 10\n  },\n  wrapper: {\n    borderRadius: 13,\n    borderColor: \"#b2b2b2\",\n    borderWidth: 2,\n    flex: 1\n  },\n  iconText: {\n    color: \"#b2b2b2\",\n    fontWeight: \"bold\",\n    fontSize: 10,\n    backgroundColor: \"transparent\",\n    textAlign: \"center\"\n  }\n});\nexport default CustomActions;","map":{"version":3,"names":["useState","TouchableOpacity","Text","View","StyleSheet","Alert","useActionSheet","ImagePicker","Location","ref","uploadBytes","getDownloadURL","jsx","_jsx","CustomActions","_ref","wrapperStyle","iconTextStyle","onSend","storage","userID","_useState","_useState2","_slicedToArray","image","setImage","_useState3","_useState4","location","setLocation","actionSheet","uploadAndSendImage","_ref2","_asyncToGenerator","imageURI","uniqueRefString","generateReference","newUploadRef","response","fetch","imageUIR","blob","then","_ref3","snapshot","imageURL","_x2","apply","arguments","_x","pickImage","_ref4","permissions","requestMediaLibraryPermissionsAsync","granted","result","launchImageLibraryAsync","canceled","assets","uri","alert","timeStamp","Date","getTime","imageName","split","length","takePhoto","_ref5","requestCameraPermissionsAsync","launchCameraAsync","getLocation","_ref6","requestForegroundPermissionsAsync","getCurrentPositionAsync","longitude","coords","latitude","onActionPress","options","cancelButtonIndex","showActionSheetWithOptions","_ref7","buttonIndex","_x3","style","styles","container","onPress","children","wrapper","iconText","create","width","height","marginLeft","marginBottom","borderRadius","borderColor","borderWidth","flex","color","fontWeight","fontSize","backgroundColor","textAlign"],"sources":["C:/Users/Christina/Documents/Career/CareerFoundry/chat-app/components/CustomActions.js"],"sourcesContent":["import { useState } from \"react\";\r\nimport { TouchableOpacity, Text, View, StyleSheet, Alert } from \"react-native\";\r\nimport { useActionSheet } from \"@expo/react-native-action-sheet\";\r\nimport * as ImagePicker from \"expo-image-picker\";\r\nimport * as Location from \"expo-location\";\r\n//import MapView from \"react-native-maps\";\r\nimport { ref, uploadBytes, getDownloadURL } from \"firebase/storage\";\r\n\r\nconst CustomActions = ({wrapperStyle, iconTextStyle, onSend, storage, userID }) => {\r\n    const [image, setImage] = useState(null);\r\n    const [location, setLocation] = useState(null);\r\n    const actionSheet = useActionSheet();\r\n\r\n    const uploadAndSendImage = async (imageURI) => {\r\n        const uniqueRefString = generateReference(imageURI);\r\n        const newUploadRef = ref(storage, uniqueRefString);\r\n        const response = await fetch(imageUIR);\r\n        const blob = await response.blob();\r\n        uploadBytes(newUploadRef, blob).then(async(snapshot) => {\r\n            const imageURL = await getDownloadURL(snapshot.ref)\r\n            onSend({ image: imageURL })\r\n        });\r\n    }\r\n\r\n    const pickImage = async () => {\r\n        let permissions = await ImagePicker.requestMediaLibraryPermissionsAsync();\r\n        if (permissions?.granted) {\r\n            let result = await ImagePicker.launchImageLibraryAsync();\r\n            if (!result.canceled) await uploadAndSendImage(result.assets[0].uri);\r\n            else Alert.alert(\"Permissions haven't been granted.\");\r\n        }\r\n    }\r\n\r\n    const generateReference = (uri) => {\r\n        const timeStamp = (new Date()).getTime();\r\n        const imageName = uri.split(\"/\")[uri.split(\"/\").length - 1];\r\n        return `${userID}-${timeStamp}-${imageName}`;\r\n    }\r\n\r\n    const takePhoto = async () => {\r\n        let permissions = await ImagePicker.requestCameraPermissionsAsync();\r\n        if(permissions?.granted) {\r\n            let result = await ImagePicker.launchCameraAsync();\r\n\r\n            if(!result.canceled) await uploadAndSendImage(result.assets[0].uri);\r\n            else Alert.alert(\"Permissions haven't been granted.\")\r\n        }\r\n    }\r\n\r\n    const getLocation = async () => {\r\n        let permissions = await Location.requestForegroundPermissionsAsync();\r\n\r\n        if (permissions?.granted) {\r\n            const location = await Location.getCurrentPositionAsync({});\r\n            if (location) {\r\n                onSend({\r\n                    location: {\r\n                        longitude: location.coords.longitude,\r\n                        latitude: location.coords.latitude\r\n                    },\r\n                });\r\n            } else Alert.alert(\"Error occurred while fetching location\");\r\n        } else Alert.alert(\"Permissions to read location aren't granted\");\r\n    }\r\n\r\n    const onActionPress = () => {\r\n        const options =[\"Choose From Library\", \"Take Picture\", \"Send Location\", \"Cancel\"];\r\n        const cancelButtonIndex = options.length -1;\r\n        actionSheet.showActionSheetWithOptions(\r\n            {\r\n                options,\r\n                cancelButtonIndex\r\n            },\r\n            async (buttonIndex) => {\r\n                switch (buttonIndex) {\r\n                    case 0:\r\n                        pickImage();\r\n                        return;\r\n                    case 1:\r\n                        takePhoto();\r\n                        return;\r\n                    case 2:\r\n                        getLocation();\r\n                    default:\r\n                }\r\n            },\r\n        );\r\n    };\r\n\r\n    return (\r\n        <TouchableOpacity style={styles.container} onPress={onActionPress}>\r\n            <View style={[styles.wrapper, wrapperStyle]}>\r\n                <Text style={[styles.iconText, iconTextStyle]}>+</Text>\r\n            </View>\r\n        </TouchableOpacity>\r\n    );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    container: {\r\n        width: 26,\r\n        height: 26,\r\n        marginLeft: 10,\r\n        marginBottom: 10\r\n    },\r\n    wrapper: {\r\n        borderRadius: 13,\r\n        borderColor: \"#b2b2b2\",\r\n        borderWidth: 2,\r\n        flex: 1\r\n    },  \r\n    iconText: {\r\n        color: \"#b2b2b2\",\r\n        fontWeight: \"bold\",\r\n        fontSize: 10,\r\n        backgroundColor: \"transparent\",\r\n        textAlign: \"center\"\r\n    }\r\n})\r\n\r\nexport default CustomActions;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}